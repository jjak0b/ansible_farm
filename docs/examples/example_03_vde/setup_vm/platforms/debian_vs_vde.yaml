- import_tasks:
    file: debian_vs.yaml

- name: Override platform
  vars: 
    new_task:
      callback: callbacks/sources/setup_connection.yaml
      src: "{{ vm.metadata.sources[0].on_provision.src }}"
  block:
    - name: Override for VDE setup
      set_fact:
        vm: "{{ vm | combine( vm_override, recursive=true) }}"
      vars:
        vm_override:
#          metadata:
#            sources:
#              - before_provision: "{{ vm.metadata.sources[0].before_provision + [ new_task ] }}"
#                on_provision: "{{ vm.metadata.sources[0].on_provision }}"
          ram: 1024
          net:
            source: "hostfwd=tcp:127.0.0.1:2202-:22"
#          net:
#            type: vde
#            source: "{{ vde_network }}"
#            ip: "10.0.0.21"
#            mask: "24"
      


